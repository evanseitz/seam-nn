seq_length: 249
Loading model...
Wild-type prediction: 5.298523426055908
joint_input shape: [(6, 249, 4)]

First few entries of joint_input:
Original data (first 3 entries):
 [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]
Background data (first few entries):
 [[[1. 0. 0. 0.]
  [0. 0. 0. 1.]
  [1. 0. 0. 0.]
  ...
  [1. 0. 0. 0.]
  [0. 1. 0. 0.]
  [1. 0. 0. 0.]]

 [[1. 0. 0. 0.]
  [0. 0. 0. 1.]
  [1. 0. 0. 0.]
  ...
  [1. 0. 0. 0.]
  [0. 1. 0. 0.]
  [1. 0. 0. 0.]]

 [[1. 0. 0. 0.]
  [0. 0. 0. 1.]
  [1. 0. 0. 0.]
  ...
  [1. 0. 0. 0.]
  [0. 1. 0. 0.]
  [1. 0. 0. 0.]]

 [[1. 0. 0. 0.]
  [1. 0. 0. 0.]
  [0. 0. 0. 1.]
  ...
  [1. 0. 0. 0.]
  [0. 1. 0. 0.]
  [1. 0. 0. 0.]]

 [[1. 0. 0. 0.]
  [0. 0. 0. 1.]
  [1. 0. 0. 0.]
  ...
  [1. 0. 0. 0.]
  [0. 1. 0. 0.]
  [1. 0. 0. 0.]]]

Full slice at position [0]:
 [[1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]
 [1. 0. 0. 0.]]

=== DeepSHAP Session Debug ===
Input shapes:
- Model input: [(1, 249, 4)]
- Background data: [(3, 249, 4)]

Model outputs:
- Shape: (1, 1)
- First few values: [[5.2985234]]

Gradient setup:
- Joint input shape: [(6, 249, 4)]
- Expected value: [-0.59891474]

Gradient computation:
- Shape: [(6, 249, 4)]
- First few values: [array([[[ 1.22853341e-02, -7.38618430e-04, -3.25747989e-02,
          6.36670459e-03],
        [ 4.78108088e-03, -1.11045446e-02, -6.14169799e-03,
          1.76509656e-03],
        [-8.28243094e-04, -1.23303216e-02, -2.24827193e-02,
          2.29433663e-02],
        [-1.02829235e-02, -1.37167526e-02, -6.06647832e-03,
          2.67939102e-02],
        [-1.74575252e-04, -1.14696342e-02, -2.37057824e-02,
          3.60874794e-02]],

       [[-1.72038178e-03,  9.71262157e-03, -1.58048440e-02,
          9.30337049e-03],
        [ 6.27604127e-03,  1.64484531e-02, -1.04724793e-02,
         -5.63246524e-03],
        [ 2.29642028e-05, -5.63198235e-03,  2.04085442e-03,
          5.79973124e-03],
        [ 7.59033021e-04,  3.00887302e-02,  3.62880947e-03,
         -1.57518666e-02],
        [-2.21853498e-02, -1.43855717e-02,  3.44924070e-03,
          4.11479436e-02]]], dtype=float32)]

=== Debug sess.py values ===
mult first few values: [ 0.01228533 -0.00073862 -0.0325748   0.0063667   0.00478108]
orig_inp first few values: [1. 0. 0. 0. 0.]
bg_data first few values: [1. 0. 0. 0. 1.]

=== Debug utils.py ===
mult[0] first few values: [ 0.01228533 -0.00073862 -0.0325748   0.0063667   0.00478108]
orig_inp[0] first few values: [1. 0. 0. 0. 0.]
bg_data[0] first few values: [1. 0. 0. 0. 1.]
Using NumPy implementation

Final attribution shape: [(249, 4)]
First few attribution values: [array([ 0.        , -0.00728255, -0.00400395, -0.00317463,  0.        ],
      dtype=float32)]
=== End of Session-based Debug ===

Gradient computation results:
Gradient shapes: [(6, 249, 4)]
First few gradient values: [array([[[ 1.22853341e-02, -7.38618430e-04, -3.25747989e-02,
          6.36670459e-03],
        [ 4.78108088e-03, -1.11045446e-02, -6.14169799e-03,
          1.76509656e-03],
        [-8.28243094e-04, -1.23303216e-02, -2.24827193e-02,
          2.29433663e-02],
        [-1.02829235e-02, -1.37167526e-02, -6.06647832e-03,
          2.67939102e-02],
        [-1.74575252e-04, -1.14696342e-02, -2.37057824e-02,
          3.60874794e-02]],

       [[-1.72038178e-03,  9.71262157e-03, -1.58048440e-02,
          9.30337049e-03],
        [ 6.27604127e-03,  1.64484531e-02, -1.04724793e-02,
         -5.63246524e-03],
        [ 2.29642028e-05, -5.63198235e-03,  2.04085442e-03,
          5.79973124e-03],
        [ 7.59033021e-04,  3.00887302e-02,  3.62880947e-03,
         -1.57518666e-02],
        [-2.21853498e-02, -1.43855717e-02,  3.44924070e-03,
          4.11479436e-02]]], dtype=float32)]

=== Final Attribution Values ===
Attribution shapes: [(249, 4)]
First few attribution values: [array([ 0.        , -0.00728255, -0.00400395, -0.00317463,  0.        ],
      dtype=float32)]
